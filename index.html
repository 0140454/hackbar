<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <!-- Vue.js -->
    <link rel="stylesheet" type="text/css" href="css/vue.js/vuetify.min.css" />
    <!-- HackBar -->
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <link rel="stylesheet" type="text/css" href="css/fonts.css" />
  </head>
  <body>
    <div id="app" v-cloak>
      <v-app>
        <v-toolbar app dense flat>
          <v-btn flat @click="loadUrl()">Load URL</v-btn>
          <v-btn flat @click="splitUrl()">Split URL</v-btn>
          <v-btn flat @click="executeUrl()">Execute URL</v-btn>
          <v-divider inset vertical></v-divider>
          <v-menu offset-y>
            <v-btn flat slot="activator">SQLi</v-btn>
            <v-list dense>
              <v-menu offset-x full-width open-on-hover>
                <v-list-tile class="full-width" slot="activator" @click="">
                  <v-list-tile-title>MySQL</v-list-tile-title>
                  <v-list-tile-action class="justify-end">
                    <v-icon>play_arrow</v-icon>
                  </v-list-tile-action>
                </v-list-tile>
                <v-list dense>
                  <v-list-tile @click="sqlInjectionPrompt('Payload.SQLi.MySQL.dumpDatabases')">
                    <v-list-tile-title>Dump all database names</v-list-tile-title>
                  </v-list-tile>
                  <v-list-tile @click="sqlInjectionPrompt('Payload.SQLi.MySQL.dumpTables')">
                    <v-list-tile-title>Dump tables from database</v-list-tile-title>
                  </v-list-tile>
                  <v-list-tile @click="sqlInjectionPrompt('Payload.SQLi.MySQL.dumpColumns')">
                    <v-list-tile-title>Dump columns from database</v-list-tile-title>
                  </v-list-tile>
                  <v-list-tile @click="sqlInjectionPrompt('Payload.SQLi.MySQL.unionSelect')">
                    <v-list-tile-title>Union select statement</v-list-tile-title>
                  </v-list-tile>
                  <v-list-tile @click="applyFunction('Payload.SQLi.MySQL.errorBased', true)">
                    <v-list-tile-title>Error-based injection statement</v-list-tile-title>
                  </v-list-tile>
                </v-list>
              </v-menu>
              <v-menu offset-x full-width open-on-hover>
                <v-list-tile class="full-width" slot="activator" @click="">
                  <v-list-tile-title>PostgreSQL</v-list-tile-title>
                  <v-list-tile-action class="justify-end">
                    <v-icon>play_arrow</v-icon>
                  </v-list-tile-action>
                </v-list-tile>
                <v-list dense>
                  <v-list-tile @click="sqlInjectionPrompt('Payload.SQLi.PostgreSQL.dumpDatabases')">
                    <v-list-tile-title>Dump all database names</v-list-tile-title>
                  </v-list-tile>
                  <v-list-tile @click="sqlInjectionPrompt('Payload.SQLi.PostgreSQL.dumpTables')">
                    <v-list-tile-title>Dump tables from database</v-list-tile-title>
                  </v-list-tile>
                  <v-list-tile @click="sqlInjectionPrompt('Payload.SQLi.PostgreSQL.dumpColumns')">
                    <v-list-tile-title>Dump columns from database</v-list-tile-title>
                  </v-list-tile>
                  <v-list-tile @click="sqlInjectionPrompt('Payload.SQLi.PostgreSQL.unionSelect')">
                    <v-list-tile-title>Union select statement</v-list-tile-title>
                  </v-list-tile>
                </v-list>
              </v-menu>
              <v-list-tile @click="applyFunction('Payload.SQLi.polyglot', true)">
                <v-list-tile-title>Polyglot</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Payload.SQLi.spaceToComment')">
                <v-list-tile-title>Space to Inline comment</v-list-tile-title>
              </v-list-tile>
            </v-list>
          </v-menu>
          <v-menu offset-y>
            <v-btn flat slot="activator">XSS</v-btn>
            <v-list dense>
              <v-list-tile @click="applyFunction('Payload.XSS.polyglot', true)">
                <v-list-tile-title>Polyglot</v-list-tile-title>
              </v-list-tile>
              <v-divider></v-divider>
              <v-list-tile @click="applyFunction('Encode.Html.encode')">
                <v-list-tile-title>Html encode</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Encode.Html.decode')">
                <v-list-tile-title>Html decode</v-list-tile-title>
              </v-list-tile>
              <v-divider></v-divider>
              <v-list-tile @click="applyFunction('Encode.CharCode.encode')">
                <v-list-tile-title>String.fromCharCode encode</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Encode.CharCode.decode')">
                <v-list-tile-title>String.fromCharCode decode</v-list-tile-title>
              </v-list-tile>
            </v-list>
          </v-menu>
          <v-menu offset-y>
            <v-btn flat slot="activator">LFI</v-btn>
            <v-list dense>
              <v-list-tile @click="applyFunction('Payload.LFI.phpWrapperBas64', true)">
                <v-list-tile-title>PHP wrapper - Base64</v-list-tile-title>
              </v-list-tile>
            </v-list>
          </v-menu>
          <v-menu offset-y>
            <v-btn flat slot="activator">Encoding</v-btn>
            <v-list dense>
              <v-list-tile @click="applyFunction('Encode.URL.encode')">
                <v-list-tile-title>URL encode</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Encode.URL.decode')">
                <v-list-tile-title>URL decode</v-list-tile-title>
              </v-list-tile>
              <v-divider></v-divider>
              <v-list-tile @click="applyFunction('Encode.Base64.encode')">
                <v-list-tile-title>Base64 encode</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Encode.Base64.decode')">
                <v-list-tile-title>Base64 decode</v-list-tile-title>
              </v-list-tile>
              <v-divider></v-divider>
              <v-list-tile @click="applyFunction('Encode.Hexadecimal.encode')">
                <v-list-tile-title>Hexadecimal encode</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Encode.Hexadecimal.decode')">
                <v-list-tile-title>Hexadecimal decode</v-list-tile-title>
              </v-list-tile>
              <v-divider></v-divider>
              <v-list-tile @click="applyFunction('Encode.Unicode.encode')">
                <v-list-tile-title>Unicode encode</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Encode.Unicode.decode')">
                <v-list-tile-title>Unicode decode</v-list-tile-title>
              </v-list-tile>
            </v-list>
          </v-menu>
          <v-menu offset-y>
            <v-btn flat slot="activator">Hashing</v-btn>
            <v-list dense>
              <v-list-tile @click="applyFunction('Hash.MD5.digest')">
                <v-list-tile-title>MD5</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Hash.SHA1.digest')">
                <v-list-tile-title>SHA1</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Hash.SHA256.digest')">
                <v-list-tile-title>SHA256</v-list-tile-title>
              </v-list-tile>
              <v-list-tile @click="applyFunction('Hash.SHA512.digest')">
                <v-list-tile-title>SHA512</v-list-tile-title>
              </v-list-tile>
            </v-list>
          </v-menu>
        </v-toolbar>
        <v-content>
          <v-container fluid>
            <v-textarea label="URL" rows="1" ref="url" auto-grow v-model="request.url" @focus="onFocus($event)" @keydown.stop></v-textarea>
            <v-layout row>
              <v-flex md6>
                <v-layout align-center>
                  <v-switch label="Enable POST" v-model="request.body.enabled"></v-switch>
                  <v-spacer></v-spacer>
                  <v-select v-model="request.body.enctype" :items="supportedEnctype()" label="enctype" v-show="request.body.enabled" dense offset-y></v-select>
                </v-layout>
                <v-textarea label="Body" rows="1" auto-grow v-show="request.body.enabled" v-model="request.body.content" @focus="onFocus($event)" @keydown.stop></v-textarea>
              </v-flex>
              <v-flex md6>
                <v-btn class="ctrl-btn" @click="addHeader()">Add Header</v-btn>
                <v-layout align-center v-for="(header, index) in request.headers" :key="index">
                  <v-checkbox class="pl-2 shrink" v-model="header.enabled"></v-checkbox>
                  <v-combobox  label="Name" class="px-1" v-model="header.name" :items="commonRequestHeaders()" @focus="onFocus($event)" :menu-props='{ "maxHeight": 200 }'></v-combobox>
                  <v-text-field label="Value" class="px-1" v-model="header.value" @focus="onFocus($event)" @keydown.stop></v-text-field>
                  <v-btn icon flat @click="deleteHeader(index)">
                    <v-icon>clear</v-icon>
                  </v-btn>
                </v-layout>
              </v-flex>
            </v-layout>
          </v-container>
        </v-content>
        <v-dialog max-width="35%" v-model="reloadDialog">
          <v-card>
            <v-card-title class="headline">
              Unable to fetch request information
            </v-card-title>
            <v-card-text class="body-1">
              After installing extension, reloading the tab is required to let
              HackBar record the request.
            </v-card-text>
            <v-card-actions>
              <v-spacer></v-spacer>
              <v-btn flat @click="reloadDialog = false">OK</v-btn>
            </v-card-actions>
          </v-card>
        </v-dialog>
        <v-dialog max-width="35%" persistent v-model="sqlInjectionDialog.show">
          <v-form @submit.prevent="sqlInjectionDialog.show = false; applyFunction(sqlInjectionDialog.func, true, sqlInjectionDialog)" v-model="sqlInjectionDialog.valid">
            <v-card>
              <v-card-title class="headline">
                SQL Injection
              </v-card-title>
              <v-card-text class="body-1">
                <p>The number of columns must be <strong>larger than</strong> or <strong>equal to</strong> output position.</p>
                <v-layout row>
                  <v-flex md6 class="pa-1">
                    <v-text-field type="number" min="1" label="The number of columns" ref="sqlInjectionInput" :rules="[v => /^[1-9][0-9]{0,}$/.test(v) || 'Invalid value']" v-model="sqlInjectionDialog.columns" @keydown.stop required></v-text-field>
                  </v-flex>
                  <v-flex md6 class="pa-1">
                    <v-text-field type="number" min="1" :max="sqlInjectionDialog.columns" label="Output position" :rules="[v => /^[1-9][0-9]{0,}$/.test(v) || 'Invalid value']" v-model="sqlInjectionDialog.position" @keydown.stop required></v-text-field>
                  </v-flex>
                </v-layout>
              </v-card-text>
              <v-card-actions>
                <v-spacer></v-spacer>
                <v-btn flat @click="sqlInjectionDialog.show = false">Cancel</v-btn>
                <v-btn flat type="submit" :disabled="!sqlInjectionDialog.valid">OK</v-btn>
              </v-card-actions>
            </v-card>
          </v-form>
        </v-dialog>
        <v-snackbar v-model="snackbar.show" color="error" timeout="3000" bottom>
          {{ snackbar.text }}
          <v-btn @click="snackbar.show = false" dark flat>Close</v-btn>
        </v-snackbar>
      </v-app>
    </div>

    <!-- Vue.js Libraries -->
    <script src="scripts/vue.js/vue.min.js" type="text/javascript"></script>
    <script src="scripts/vue.js/vuetify.min.js" type="text/javascript"></script>
    <!-- crypto-js Libraries -->
    <script src="scripts/crypto-js/core.min.js" type="text/javascript"></script>
    <script src="scripts/crypto-js/x64-core.min.js" type="text/javascript"></script>
    <script src="scripts/crypto-js/enc-base64.min.js" type="text/javascript"></script>
    <script src="scripts/crypto-js/enc-hex.min.js" type="text/javascript"></script>
    <script src="scripts/crypto-js/enc-latin1.min.js" type="text/javascript"></script>
    <script src="scripts/crypto-js/enc-utf8.min.js" type="text/javascript"></script>
    <script src="scripts/crypto-js/md5.min.js" type="text/javascript"></script>
    <script src="scripts/crypto-js/sha1.min.js" type="text/javascript"></script>
    <script src="scripts/crypto-js/sha256.min.js" type="text/javascript"></script>
    <script src="scripts/crypto-js/sha512.min.js" type="text/javascript"></script>
    <!-- HackBar -->
    <script src="scripts/lib/payload.js" type="text/javascript"></script>
    <script src="scripts/lib/encode.js" type="text/javascript"></script>
    <script src="scripts/lib/hash.js" type="text/javascript"></script>
    <script src="scripts/index.js" type="text/javascript"></script>
  </body>
</html>
